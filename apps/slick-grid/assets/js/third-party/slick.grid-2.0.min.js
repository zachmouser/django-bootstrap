/*

 (c) 2009-2012 Michael Leibman
 michael{dot}leibman{at}gmail{dot}com
 http://github.com/mleibman/slickgrid

 Distributed under MIT license.
 All rights reserved.

 SlickGrid v2.0

 NOTES:
     Cell/row DOM manipulations are done directly bypassing jQuery's DOM manipulation methods.
     This increases the speed dramatically, but can only be done safely because there are no event handlers
     or data associated with any cell/row DOM nodes.  Cell editors must make sure they implement .destroy()
     and do proper cleanup.
*/
if("undefined"===typeof jQuery)throw"SlickGrid requires jquery module to be loaded";if(!jQuery.fn.drag)throw"SlickGrid requires jquery.event.drag module to be loaded";if("undefined"===typeof Slick)throw"slick.core.js not loaded";
(function(f){f.extend(!0,window,{Slick:{Grid:function(hb,x,h,d){function ib(){I||(I=!0,W=parseFloat(f.css(p[0],"width",!0)),Yb(),Zb(q),d.enableTextSelectionOnCells||w.bind("selectstart.ui",function(a){return f(a.target).is("input,textarea")}),jb(),$b(),kb(),N(),ac(),p.bind("resize.slickgrid",N),w.bind("scroll.slickgrid",La),fa.bind("contextmenu.slickgrid",bc).bind("click.slickgrid",cc).delegate(".slick-header-column","mouseenter",dc).delegate(".slick-header-column","mouseleave",ec),Ma.bind("keydown.slickgrid",
lb),C.bind("keydown.slickgrid",lb).bind("click.slickgrid",fc).bind("dblclick.slickgrid",gc).bind("contextmenu.slickgrid",hc).bind("draginit",ic).bind("dragstart",jc).bind("drag",kc).bind("dragend",lc).delegate(".slick-cell","mouseenter",mc).delegate(".slick-cell","mouseleave",nc))}function mb(a){for(var b=Q.length;0<=b;b--)if(Q[b]===a){Q[b].destroy&&Q[b].destroy();Q.splice(b,1);break}}function oc(){var a=f("<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>").appendTo("body"),
b={width:a.width()-a[0].clientWidth,height:a.height()-a[0].clientHeight};a.remove();return b}function Na(a){for(var b=R,c=oa?W-S.width:W,e=0,J=h.length;J--;)e+=h[J].width||Oa.width;R=d.fullWidthRows?Math.max(e,c):e;R!=b&&(C.width(R),ga.width(R),Pa=R>W-S.width);(R!=b||a)&&Qa()}function Zb(a){a&&a.jquery&&a.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function pc(){for(var a=1E6,b=f.browser.mozilla?6E6:1E9,c=f("<div style='display:none' />").appendTo(document.body);;){var e=
2*a;c.css("height",e);if(e>b||c.height()!==e)break;else a=e}c.remove();return a}function ac(){for(var a=C[0];(a=a.parentNode)!=document.body&&null!=a;)a!=w[0]&&a.scrollWidth==a.clientWidth&&a.scrollHeight==a.clientHeight||f(a).bind("scroll.slickgrid",nb)}function jb(){function a(){f(this).addClass("ui-state-hover")}function b(){f(this).removeClass("ui-state-hover")}q.find(".slick-header-column").each(function(){var a=f(this).data("column");a&&k(g.onBeforeHeaderDestroy,{headerNode:this,column:a})});
q.empty();ga.empty();K={};for(var c=0;c<h.length;c++){var e=h[c]=f.extend({},Oa,h[c]);K[e.id]=c;var J=f("<div class='ui-state-default slick-header-column' id='"+D+e.id+"' />").html("<span class='slick-column-name'>"+e.name+"</span>").width(e.width-X).attr("title",e.toolTip||"").data("column",e).addClass(e.headerCssClass||"").appendTo(q);(d.enableColumnReorder||e.sortable)&&J.hover(a,b);e.sortable&&J.append("<span class='slick-sort-indicator' />");k(g.onHeaderRendered,{headerNode:J[0],column:e});d.showHeaderRow&&
f("<div class='ui-state-default slick-headerrow-column l"+c+" r"+c+"'></div>").appendTo(ga)}d.showHeaderRow&&f("<div style='display:block;height:1px;width:10000px;position:absolute;top:0;left:0;'></div>").appendTo(T);ua(t);pb();d.enableColumnReorder&&qc()}function $b(){q.click(function(a){a.metaKey=a.metaKey||a.ctrlKey;if(!f(a.target).hasClass("slick-resizable-handle")){var b=f(a.target).closest(".slick-header-column");if(b.length&&(b=b.data("column"),b.sortable&&r().commitCurrentEdit())){for(var c=
null,e=0;e<t.length;e++)if(t[e].columnId==b.id){c=t[e];c.sortAsc=!c.sortAsc;break}a.metaKey&&d.multiColumnSort?c&&t.splice(e,1):((a.shiftKey||a.metaKey)&&d.multiColumnSort||(t=[]),c?0==t.length&&t.push(c):(c={columnId:b.id,sortAsc:!0},t.push(c)));ua(t);d.multiColumnSort?k(g.onSort,{multiColumnSort:!0,sortCols:f.map(t,function(a){return{sortCol:h[K[a.columnId]],sortAsc:a.sortAsc}})},a):k(g.onSort,{multiColumnSort:!1,sortCol:b,sortAsc:c.sortAsc},a)}}})}function qc(){q.sortable({containment:"parent",
axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",forcePlaceholderSize:!0,start:function(a,b){f(b.helper).addClass("slick-header-column-active")},beforeStop:function(a,b){f(b.helper).removeClass("slick-header-column-active")},stop:function(a){if(r().commitCurrentEdit()){for(var b=q.sortable("toArray"),c=[],e=0;e<b.length;e++)c.push(h[qb(b[e].replace(D,""))]);rb(c);k(g.onColumnsReordered,{});a.stopPropagation();
pb()}else f(this).sortable("cancel")}})}function pb(){var a,b,c,e,J,ob,E,l;e=q.children();e.find(".slick-resizable-handle").remove();e.each(function(a,b){h[a].resizable&&(void 0===E&&(E=a),l=a)});void 0!==E&&e.each(function(m,n){m<E||d.forceFitColumns&&m>=l||(f(n),f("<div class='slick-resizable-handle' />").appendTo(n).bind("dragstart",function(E,g){if(!r().commitCurrentEdit())return!1;c=E.pageX;f(this).parent().addClass("slick-header-column-active");var l=null,k=null;e.each(function(a,b){h[a].previousWidth=
f(b).outerWidth()});if(d.forceFitColumns)for(k=l=0,a=m+1;a<e.length;a++)b=h[a],b.resizable&&(null!==k&&(k=b.maxWidth?k+(b.maxWidth-b.previousWidth):null),l+=b.previousWidth-Math.max(b.minWidth||0,U));var pa=0,n=0;for(a=0;a<=m;a++)b=h[a],b.resizable&&(null!==n&&(n=b.maxWidth?n+(b.maxWidth-b.previousWidth):null),pa+=b.previousWidth-Math.max(b.minWidth||0,U));null===l&&(l=1E5);null===pa&&(pa=1E5);null===k&&(k=1E5);null===n&&(n=1E5);ob=c+Math.min(l,n);J=c-Math.min(pa,k)}).bind("drag",function(f,l){var k,
E=Math.min(ob,Math.max(J,f.pageX))-c,g;if(0>E){g=E;for(a=m;0<=a;a--)b=h[a],b.resizable&&(k=Math.max(b.minWidth||0,U),g&&b.previousWidth+g<k?(g+=b.previousWidth-k,b.width=k):(b.width=b.previousWidth+g,g=0));if(d.forceFitColumns)for(g=-E,a=m+1;a<e.length;a++)b=h[a],b.resizable&&(g&&b.maxWidth&&b.maxWidth-b.previousWidth<g?(g-=b.maxWidth-b.previousWidth,b.width=b.maxWidth):(b.width=b.previousWidth+g,g=0))}else{g=E;for(a=m;0<=a;a--)b=h[a],b.resizable&&(g&&b.maxWidth&&b.maxWidth-b.previousWidth<g?(g-=
b.maxWidth-b.previousWidth,b.width=b.maxWidth):(b.width=b.previousWidth+g,g=0));if(d.forceFitColumns)for(g=-E,a=m+1;a<e.length;a++)b=h[a],b.resizable&&(k=Math.max(b.minWidth||0,U),g&&b.previousWidth+g<k?(g+=b.previousWidth-k,b.width=k):(b.width=b.previousWidth+g,g=0))}sb();d.syncColumnCellResize&&Qa()}).bind("dragend",function(c,J){var d;f(this).parent().removeClass("slick-header-column-active");for(a=0;a<e.length;a++)b=h[a],d=f(e[a]).outerWidth(),b.previousWidth!==d&&b.rerenderOnResize&&Y();Na(!0);
B();k(g.onColumnsResized,{})}))})}function Ra(a){var b=0;f.each(["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],function(c,e){b+=parseFloat(a.css(e))||0});return b}function Yb(){var a,b=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];a=f("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo(q);X=Sa=0;f.each(b,function(b,c){X+=parseFloat(a.css(c))||
0});f.each(c,function(b,c){Sa+=parseFloat(a.css(c))||0});a.remove();var e=f("<div class='slick-row' />").appendTo(C);a=f("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(e);va=wa=0;f.each(b,function(b,c){va+=parseFloat(a.css(c))||0});f.each(c,function(b,c){wa+=parseFloat(a.css(c))||0});e.remove();U=Math.max(X,va)}function kb(){Z=f("<style type='text/css' rel='stylesheet' />").appendTo(f("head"));for(var a=["."+D+" .slick-header-column { left: 1000px; }","."+D+" .slick-top-panel { height:"+
d.topPanelHeight+"px; }","."+D+" .slick-headerrow-columns { height:"+d.headerRowHeight+"px; }","."+D+" .slick-cell { height:"+(d.rowHeight-wa)+"px; }","."+D+" .slick-row { height:"+d.rowHeight+"px; }"],b=0;b<h.length;b++)a.push("."+D+" .l"+b+" { }"),a.push("."+D+" .r"+b+" { }");Z[0].styleSheet?Z[0].styleSheet.cssText=a.join(" "):Z[0].appendChild(document.createTextNode(a.join(" ")))}function k(a,b,c){c=c||new Slick.EventData;b=b||{};b.grid=g;return a.notify(b,c,g)}function r(){return d.editorLock}
function qb(a){return K[a]}function Ta(){var a,b,c=[],e=0,d=0,f,g=oa?W-S.width:W;for(a=0;a<h.length;a++)b=h[a],c.push(b.width),d+=b.width,b.resizable&&(e+=b.width-Math.max(b.minWidth,U));for(f=d;d>g&&e;){var k=(d-g)/e;for(a=0;a<h.length&&d>g;a++){b=h[a];var l=c[a];if(b.resizable&&!(l<=b.minWidth||l<=U)){b=Math.max(b.minWidth,U);var m=Math.floor(k*(l-b))||1,m=Math.min(m,l-b),d=d-m,e=e-m;c[a]-=m}}if(f==d)break;f=d}for(f=d;d<g;){e=g/d;for(a=0;a<h.length&&d<g;a++)b=h[a],!b.resizable||b.maxWidth<=b.width||
(k=Math.min(Math.floor(e*b.width)-b.width,b.maxWidth-b.width||1E6)||1,d+=k,c[a]+=k);if(f==d)break;f=d}d=!1;for(a=0;a<h.length;a++)h[a].rerenderOnResize&&h[a].width!=c[a]&&(d=!0),h[a].width=c[a];sb();Na(!0);d&&(Y(),B())}function sb(){if(I)for(var a,b=0,c=q.children(),e=c.length;b<e;b++)a=f(c[b]),a.width()!==h[b].width-X&&a.width(h[b].width-X)}function Qa(){for(var a,b,c=0,e,d=0;d<h.length;d++){e=h[d].width;b=d;if(!$){var f=document.styleSheets;for(a=0;a<f.length;a++)if((f[a].ownerNode||f[a].owningElement)==
Z[0]){$=f[a];break}if(!$)throw Error("Cannot find stylesheet.");Ua=[];Va=[];var f=$.cssRules||$.rules,g=void 0,g=void 0;for(a=0;a<f.length;a++){var k=f[a].selectorText;if(g=/\.l\d+/.exec(k))g=parseInt(g[0].substr(2,g[0].length-2),10),Ua[g]=f[a];else if(g=/\.r\d+/.exec(k))g=parseInt(g[0].substr(2,g[0].length-2),10),Va[g]=f[a]}}a=Ua[b];b=Va[b];a.style.left=c+"px";b.style.right=R-c-e+"px";c+=h[d].width}}function ua(a){t=a;var b=q.children();b.removeClass("slick-header-column-sorted").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc");
f.each(t,function(a,e){null==e.sortAsc&&(e.sortAsc=!0);var d=K[e.columnId];null!=d&&b.eq(d).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(e.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc")})}function tb(a,b){Wa=[];for(var c={},e=0;e<b.length;e++)for(var f=b[e].fromRow;f<=b[e].toRow;f++){c[f]||Wa.push(f);c[f]={};for(var l=b[e].fromCell;l<=b[e].toCell;l++)ub(f,l)&&(c[f][h[l].id]=d.selectedCellCssClass)}vb(d.selectedCellCssClass,c);k(g.onSelectedRowsChanged,
{rows:wb()},a)}function rb(a){h=a;I&&(Y(),jb(),Z.remove(),$=null,kb(),N(),Qa(),La())}function s(){return x.getLength?x.getLength():x.length}function L(a){return x.getItem?x.getItem(a):x[a]}function aa(a){a=Math.max(a,0);a=Math.min(a,M-u+(Pa?S.height:0));var b=y;ha=Math.min(ia-1,Math.floor(a/ja));y=Math.round(ha*xa);a-=y;if(y!=b){var c=ya(a);xb(c.top,c.bottom);for(var e in z)z[e].rowNode.style.top=e*d.rowHeight-y+"px"}ka!=a&&(ba=ka+b<a+y?1:-1,w[0].scrollTop=za=A=ka=a,k(g.onViewportChanged,{}))}function Aa(a,
b){var c=x.getItemMetadata&&x.getItemMetadata(a),e=c&&c.columns&&(c.columns[b.id]||c.columns[K[b.id]]);return e&&e.formatter||c&&c.formatter||b.formatter||d.formatterFactory&&d.formatterFactory.getFormatter(b)||d.defaultFormatter}function yb(a,b){var c=h[b],e=x.getItemMetadata&&x.getItemMetadata(a);return(e=e&&e.columns)&&e[c.id]&&void 0!==e[c.id].editor?e[c.id].editor:e&&e[b]&&void 0!==e[b].editor?e[b].editor:c.editor||d.editorFactory&&d.editorFactory.getEditor(c)}function Ba(a,b){return d.dataItemColumnValueExtractor?
d.dataItemColumnValueExtractor(a,b):a[b.field]}function xb(a){for(var b in z)(b=parseInt(b,10))!==m&&(b<a.top||b>a.bottom)&&Ca(b)}function Y(){l&&O();for(var a in z)Ca(a)}function Ca(a){var b=z[a];b&&(C[0].removeChild(b.rowNode),delete z[a],delete Da[a],Xa--,zb++)}function Ab(a){var b,c;if(a&&a.length)for(b=ba=0,c=a.length;b<c;b++)l&&m===a[b]&&O(),z[a[b]]&&Ca(a[b])}function Bb(a){Ab([a])}function Ya(a){var b=z[a];if(b){Za(a);for(var c in b.cellNodesByColumnIdx){c|=0;var e=h[c],d=L(a),f=b.cellNodesByColumnIdx[c];
a===m&&c===v&&l?l.loadValue(d):f.innerHTML=d?Aa(a,e)(a,c,Ba(d,e),e,d):""}$a(a)}}function N(){I&&(u=d.autoHeight?d.rowHeight*(s()+(d.enableAddRow?1:0)+(d.leaveSpaceForNewRows?Ea-1:0)):parseFloat(f.css(p[0],"height",!0))-parseFloat(f.css(fa[0],"height"))-Ra(fa)-(d.showTopPanel?d.topPanelHeight+Ra(ca):0)-(d.showHeaderRow?d.headerRowHeight+Ra(T):0),Ea=Math.ceil(u/d.rowHeight),W=parseFloat(f.css(p[0],"width",!0)),w.height(u),d.forceFitColumns&&Ta(),Fa(),La(),B())}function Fa(){if(I){ab=s()+(d.enableAddRow?
1:0)+(d.leaveSpaceForNewRows?Ea-1:0);var a=oa;oa=!d.autoHeight&&ab*d.rowHeight>u;var b=d.enableAddRow?s():s()-1,c;for(c in z)c>=b&&Ca(c);b=P;M=Math.max(d.rowHeight*ab,u-S.height);M<qa?(P=ja=M,ia=1,xa=0):(P=qa,ja=P/100,ia=Math.floor(M/ja),xa=(M-P)/(ia-1));P!==b&&(C.css("height",P),A=w[0].scrollTop);c=A+y<=M-u;0==M||0==A?ha=y=0:c?aa(A+y):aa(M-u);P!=b&&d.autoHeight&&N();d.forceFitColumns&&a!=oa&&Ta();Na(!1)}}function ya(a){null==a&&(a=A);return{top:Math.floor((a+y)/d.rowHeight),bottom:Math.ceil((a+y+
u)/d.rowHeight)}}function Cb(a){a=ya(a);var b=Math.round(u/d.rowHeight);-1==ba?(a.top-=b,a.bottom+=3):1==ba?(a.top-=3,a.bottom+=b):(a.top-=3,a.bottom+=3);a.top=Math.max(0,a.top);a.bottom=Math.min(d.enableAddRow?s():s()-1,a.bottom);return a}function Za(a){var b=z[a];if(b&&!b.cellNodes){b.cellNodes=[];b.cellNodesByColumnIdx=[];for(var c=0,e=b.rowNode.childNodes,d=0,f=e.length;d<f;d++)b.cellNodesByColumnIdx[c]=b.cellNodes[d]=e[d],c+=da(a,c)}}function Db(){d.enableAsyncPostRender&&(clearTimeout(bb),bb=
setTimeout(Eb,d.asyncPostRenderDelay))}function $a(a){delete Da[a];la=Math.min(la,a);ra=Math.max(ra,a);Db()}function B(){if(I){var a=ya(),b=Cb();xb(b);for(var c=C[0],e=[],f=[],g=!1,k=b.top;k<=b.bottom;k++)if(!z[k]){Xa++;f.push(k);var l=e,p=k,w=L(p),r=void 0,u="slick-row"+(p<s()&&!w?" loading":"")+(1==p%2?" odd":" even"),q=x.getItemMetadata&&x.getItemMetadata(p);q&&q.cssClasses&&(u+=" "+q.cssClasses);l.push("<div class='ui-widget-content "+u+"' style='top:"+(d.rowHeight*p-y)+"px'>");for(var q=u=void 0,
t=0,D=h.length;t<D;t++){q=h[t];u=da(p,t);r="slick-cell l"+t+" r"+Math.min(h.length-1,t+u-1)+(q.cssClass?" "+q.cssClass:"");p===m&&t===v&&(r+=" active");for(var B in F)F[B][p]&&F[B][p][q.id]&&(r+=" "+F[B][p][q.id]);l.push("<div class='"+r+"'>");w&&(r=Ba(w,q),l.push(Aa(p,q)(p,t,r,q,w)));l.push("</div>");u&&(t+=u-1)}l.push("</div>");n&&m===k&&(g=!0);Fb++}if(f.length){b=document.createElement("div");b.innerHTML=e.join("");k=0;for(e=b.childNodes.length;k<e;k++)z[f[k]]={rowNode:c.appendChild(b.firstChild),
cellNodes:null,cellNodesByColumnIdx:null};g&&(n=G(m,v))}la=a.top;ra=Math.min(d.enableAddRow?s():s()-1,a.bottom);Db();za=A;Ga=null}}function La(){A=w[0].scrollTop;var a=w[0].scrollLeft,b=Math.abs(A-ka);a!==Gb&&(Gb=a,fa[0].scrollLeft=a,ca[0].scrollLeft=a,T[0].scrollLeft=a);b&&(ba=ka<A?1:-1,ka=A,b<u?aa(A+y):(b=y,ha=Math.min(ia-1,Math.floor(A*((M-u)/(P-u))*(1/ja))),y=Math.round(ha*xa),b!=y&&Y()),Ga&&clearTimeout(Ga),Math.abs(za-A)<u?20<Math.abs(za-A)&&B():Ga=setTimeout(B,50),k(g.onViewportChanged,{}));
k(g.onScroll,{scrollLeft:a,scrollTop:A})}function Eb(){for(;la<=ra;){var a=0<=ba?la++:ra--,b=z[a];if(b&&!(Da[a]||a>=s())){Za(a);for(var c=0;c<b.cellNodesByColumnIdx.length;c++){var e=h[c];e.asyncPostRender&&e.asyncPostRender(b.cellNodesByColumnIdx[c],la,L(a),e)}Da[a]=!0;bb=setTimeout(Eb,d.asyncPostRenderDelay);break}}}function cb(a,b){var c,e,d,g,h;for(h in z){g=b&&b[h];d=a&&a[h];if(g)for(e in g)d&&g[e]==d[e]||(c=G(h,K[e]))&&f(c).removeClass(g[e]);if(d)for(e in d)g&&g[e]==d[e]||(c=G(h,K[e]))&&f(c).addClass(d[e])}}
function vb(a,b){var c=F[a];F[a]=b;cb(b,c);k(g.onCellCssStylesChanged,{key:a,hash:b})}function ic(a,b){var c=sa(a);if(!c||!db(c.row,c.cell))return!1;retval=k(g.onDragInit,b,a);return a.isImmediatePropagationStopped()?retval:!1}function jc(a,b){var c=sa(a);if(!c||!db(c.row,c.cell))return!1;c=k(g.onDragStart,b,a);return a.isImmediatePropagationStopped()?c:!1}function kc(a,b){return k(g.onDrag,b,a)}function lc(a,b){k(g.onDragEnd,b,a)}function lb(a){k(g.onKeyDown,{row:m,cell:v},a);if(!a.isImmediatePropagationStopped())if(a.shiftKey||
a.altKey||a.ctrlKey){if(9!=a.which||!a.shiftKey||a.ctrlKey||a.altKey)return;Hb()}else if(27==a.which){if(!r().isActive())return;Ib()}else if(37==a.which)Jb();else if(39==a.which)Kb();else if(38==a.which)Lb();else if(40==a.which)Ha();else if(9==a.which)Mb();else if(13==a.which)d.editable&&(l?m===s()?Ha():Nb():r().commitCurrentEdit()&&Ia());else return;a.stopPropagation();a.preventDefault();try{a.originalEvent.keyCode=0}catch(b){}}function fc(a){l||a.target!=document.activeElement&&ea();var b=sa(a);
!b||null!==l&&m==b.row&&v==b.cell||(k(g.onClick,{row:b.row,cell:b.cell},a),a.isImmediatePropagationStopped()||v==b.cell&&m==b.row||!V(b.row,b.cell)||r().isActive()&&!r().commitCurrentEdit()||(ta(b.row,!1),ma(G(b.row,b.cell),b.row===s()||d.autoEdit)))}function hc(a){var b=f(a.target).closest(".slick-cell",C);0!==b.length&&(n===b[0]&&null!==l||k(g.onContextMenu,{},a))}function gc(a){var b=sa(a);!b||null!==l&&m==b.row&&v==b.cell||(k(g.onDblClick,{row:b.row,cell:b.cell},a),a.isImmediatePropagationStopped()||
d.editable&&Ob(b.row,b.cell,!0))}function dc(a){k(g.onHeaderMouseEnter,{column:f(this).data("column")},a)}function ec(a){k(g.onHeaderMouseLeave,{column:f(this).data("column")},a)}function bc(a){var b=f(a.target).closest(".slick-header-column",".slick-header-columns"),b=b&&b.data("column");k(g.onHeaderContextMenu,{column:b},a)}function cc(a){var b=f(a.target).closest(".slick-header-column",".slick-header-columns");(b=b&&b.data("column"))&&k(g.onHeaderClick,{column:b},a)}function mc(a){k(g.onMouseEnter,
{},a)}function nc(a){k(g.onMouseLeave,{},a)}function db(a,b){return!(0>a||a>=s()||0>b||b>=h.length)}function Pb(a){var b=/l\d+/.exec(a.className);if(!b)throw"getCellFromNode: cannot get cell - "+a.className;return parseInt(b[0].substr(1,b[0].length-1),10)}function Qb(a){for(var b in z)if(z[b].rowNode===a)return b|0;return null}function sa(a){var b=f(a.target).closest(".slick-cell",C);if(!b.length)return null;a=Qb(b[0].parentNode);b=Pb(b[0]);return null==a||null==b?null:{row:a,cell:b}}function ea(){Ma[0].focus()}
function rc(){if(n){var a=f(n).position().left,b=a+f(n).outerWidth(),c=w.scrollLeft(),e=c+w.width();a<c?w.scrollLeft(a):b>e&&w.scrollLeft(Math.min(a,b-w[0].clientWidth))}}function ma(a,b){null!==n&&(O(),f(n).removeClass("active"));var c=n!==a;n=a;null!=n?(m=Qb(n.parentNode),v=eb=Pb(n),f(n).addClass("active"),d.editable&&b&&Rb(m,v)&&(clearTimeout(fb),d.asyncEditorLoading?fb=setTimeout(function(){Ia()},d.asyncEditorLoadDelay):Ia())):m=v=null;c&&(rc(),k(g.onActiveCellChanged,Sb()))}function Rb(a,b){return a<
s()&&!L(a)||h[b].cannotTriggerInsert&&a>=s()||!yb(a,b)?!1:!0}function O(){if(l){k(g.onBeforeCellEditorDestroy,{editor:l});l.destroy();l=null;if(n){var a=L(m);f(n).removeClass("editable invalid");if(a){var b=h[v],c=Aa(m,b);n.innerHTML=c(m,v,Ba(a,b),b,L(m));$a(m)}}f.browser.msie&&(document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&(a=window.getSelection())&&a.removeAllRanges&&a.removeAllRanges());r().deactivate(Ja)}}function Ia(a){if(n){if(!d.editable)throw"Grid : makeActiveCellEditable : should never get called when options.editable is false";
clearTimeout(fb);if(Rb(m,v)){var b=h[v],c=L(m);!1===k(g.onBeforeEditCell,{row:m,cell:v,item:c,column:b})?ea():(r().activate(Ja),f(n).addClass("editable"),a||(n.innerHTML=""),l=new (a||yb(m,v))({grid:g,gridPosition:Ka(p[0]),position:Ka(n),container:n,column:b,item:c||{},commitChanges:Nb,cancelChanges:Ib}),c&&l.loadValue(c),Tb=l.serializeValue(),l.position&&nb())}}}function Nb(){r().commitCurrentEdit()&&(ea(),d.autoEdit&&Ha())}function Ib(){r().cancelCurrentEdit()&&ea()}function Ka(a){var b={top:a.offsetTop,
left:a.offsetLeft,bottom:0,right:0,width:f(a).outerWidth(),height:f(a).outerHeight(),visible:!0};b.bottom=b.top+b.height;b.right=b.left+b.width;for(var c=a.offsetParent;(a=a.parentNode)!=document.body;)b.visible&&a.scrollHeight!=a.offsetHeight&&"visible"!=f(a).css("overflowY")&&(b.visible=b.bottom>a.scrollTop&&b.top<a.scrollTop+a.clientHeight),b.visible&&a.scrollWidth!=a.offsetWidth&&"visible"!=f(a).css("overflowX")&&(b.visible=b.right>a.scrollLeft&&b.left<a.scrollLeft+a.clientWidth),b.left-=a.scrollLeft,
b.top-=a.scrollTop,a===c&&(b.left+=a.offsetLeft,b.top+=a.offsetTop,c=a.offsetParent),b.bottom=b.top+b.height,b.right=b.left+b.width;return b}function Ub(){return Ka(n)}function nb(){if(n&&(k(g.onActiveCellPositionChanged,{}),l)){var a=Ub();l.show&&l.hide&&(a.visible?l.show():l.hide());l.position&&l.position(a)}}function Sb(){return n?{row:m,cell:v}:null}function ta(a,b){var c=a*d.rowHeight,e=(a+1)*d.rowHeight-u+(Pa?S.height:0);(a+1)*d.rowHeight>A+u+y?(aa(b?c:e),B()):a*d.rowHeight<A+y&&(aa(b?e:c),
B())}function da(a,b){var c=x.getItemMetadata&&x.getItemMetadata(a);if(!c||!c.columns)return 1;c=(c=c.columns[h[b].id]||c.columns[b])&&c.colspan;"*"===c&&(c=h.length-b);return c||1}function Vb(a){for(var b=0;b<h.length;){if(V(a,b))return b;b+=da(a,b)}return null}function gb(a,b,c){if(b>=h.length)return null;do b+=da(a,b);while(b<h.length&&!V(a,b));return b<h.length?{row:a,cell:b,posX:b}:null}function Wb(a,b,c){if(0>=b)return null;c=Vb(a);if(null===c||c>=b)return null;for(a={row:a,cell:c,posX:c};;){c=
gb(a.row,a.cell,a.posX);if(!c)return null;if(c.cell>=b)return a;a=c}}function sc(a,b,c){for(var e;;){if(++a>=s()+(d.enableAddRow?1:0))return null;for(e=b=0;b<=c;)e=b,b+=da(a,b);if(V(a,e))return{row:a,cell:e,posX:c}}}function tc(a,b,c){for(var e;;){if(0>--a)return null;for(e=b=0;b<=c;)e=b,b+=da(a,b);if(V(a,e))return{row:a,cell:e,posX:c}}}function uc(a,b,c){if(b=gb(a,b,c))return b;for(b=null;++a<s()+(d.enableAddRow?1:0);)if(b=Vb(a),null!==b)return{row:a,cell:b,posX:b};return null}function vc(a,b,c){for(var e,
d;!e&&!(e=Wb(a,b,c));){if(0>--a)return null;b=0;d=a;for(var f=0,g=null;f<h.length;)V(d,f)&&(g=f),f+=da(d,f);d=g;null!==d&&(e={row:a,cell:d,posX:d})}return e}function Kb(){na("right")}function Jb(){na("left")}function Ha(){na("down")}function Lb(){na("up")}function Mb(){na("next")}function Hb(){na("prev")}function na(a){if(n&&d.enableCellNavigation&&r().commitCurrentEdit())if(ea(),a=(0,{up:tc,down:sc,left:Wb,right:gb,prev:vc,next:uc}[a])(m,v,eb)){var b=a.row==s();ta(a.row,!b);ma(G(a.row,a.cell),b||
d.autoEdit);eb=a.posX}else ma(G(m,v),m==s()||d.autoEdit)}function G(a,b){return z[a]?(Za(a),z[a].cellNodesByColumnIdx[b]):null}function V(a,b){if(!d.enableCellNavigation||a>=s()+(d.enableAddRow?1:0)||0>a||b>=h.length||0>b)return!1;var c=x.getItemMetadata&&x.getItemMetadata(a);return c&&"boolean"===typeof c.focusable?c.focusable:(c=c&&c.columns)&&c[h[b].id]&&"boolean"===typeof c[h[b].id].focusable?c[h[b].id].focusable:c&&c[b]&&"boolean"===typeof c[b].focusable?c[b].focusable:"boolean"===typeof h[b].focusable?
h[b].focusable:!0}function ub(a,b){if(a>=s()||0>a||b>=h.length||0>b)return!1;var c=x.getItemMetadata&&x.getItemMetadata(a);return c&&"boolean"===typeof c.selectable?c.selectable:(c=c&&c.columns&&(c.columns[h[b].id]||c.columns[b]))&&"boolean"===typeof c.selectable?c.selectable:"boolean"===typeof h[b].selectable?h[b].selectable:!0}function Ob(a,b,c){I&&V(a,b)&&r().commitCurrentEdit()&&(ta(a,!1),b=G(a,b),ma(b,c||a===s()||d.autoEdit),l||ea())}function wc(a){for(var b=[],c=h.length-1,d=0;d<a.length;d++)b.push(new Slick.Range(a[d],
0,a[d],c));return b}function wb(){if(!H)throw"Selection model is not set";return Wa}var xc={explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:60,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showHeaderRow:!1,headerRowHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,
editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,fullWidthRows:!1,multiColumnSort:!1,defaultFormatter:function(a,b,c,d,f){return null==c?"":c.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}},Oa={name:"",resizable:!0,sortable:!1,minWidth:30,rerenderOnResize:!1,headerCssClass:null},M,P,ja,ia,xa,ha=0,y=0,ba=1,I=!1,p,D="slickgrid_"+Math.round(1E6*Math.random()),
g=this,Ma,fa,q,ga,T,ca,Xb,w,C,Z,$,Ua,Va,u,W,R,Pa,oa,X=0,Sa=0,va=0,wa=0,U,ab=0,eb,m,v,n=null,l=null,Tb,Ja,z={},Xa=0,Ea,ka=0,A=0,za=0,Gb=0,H,Wa=[],Q=[],F={},K={},t=[],fb=null,Ga=null,bb=null,Da={},ra=null,la=null,Fb=0,zb=0;this.debug=function(){var a;a="\ncounter_rows_rendered:  "+Fb;a+="\ncounter_rows_removed:  "+zb;a+="\nrenderedRows:  "+Xa;a+="\nnumVisibleRows:  "+Ea;a+="\nmaxSupportedCssHeight:  "+qa;a+="\nn(umber of pages):  "+ia;a+="\n(current) page:  "+ha;a+="\npage height (ph):  "+ja;a+="\nscrollDir:  "+
ba;alert(a)};this.eval=function(a){return eval(a)};f.extend(this,{slickGridVersion:"2.0",onScroll:new Slick.Event,onSort:new Slick.Event,onHeaderMouseEnter:new Slick.Event,onHeaderMouseLeave:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onHeaderRendered:new Slick.Event,onBeforeHeaderDestroy:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,onKeyDown:new Slick.Event,
onAddNewRow:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsResized:new Slick.Event,onCellChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,onSelectedRowsChanged:new Slick.Event,
onCellCssStylesChanged:new Slick.Event,registerPlugin:function(a){Q.unshift(a);a.init(g)},unregisterPlugin:mb,getColumns:function(){return h},setColumns:rb,getColumnIndex:qb,updateColumnHeader:function(a,b,c){if(I){a=K[a];var d=h[a],f=q.children().eq(a);f&&(void 0!==b&&(h[a].name=b),void 0!==c&&(h[a].toolTip=c),k(g.onBeforeHeaderDestroy,{headerNode:f[0],column:d}),f.attr("title",c||"").children().eq(0).html(b),k(g.onHeaderRendered,{headerNode:f[0],column:d}))}},setSortColumn:function(a,b){ua([{columnId:a,
sortAsc:b}])},setSortColumns:ua,getSortColumns:function(){return t},autosizeColumns:Ta,getOptions:function(){return d},setOptions:function(a){r().commitCurrentEdit()&&(O(),d.enableAddRow!==a.enableAddRow&&Bb(s()),d=f.extend(d,a),w.css("overflow-y",d.autoHeight?"hidden":"auto"),B())},getData:function(){return x},getDataLength:s,getDataItem:L,setData:function(a,b){x=a;Y();Fa();b&&aa(0)},getSelectionModel:function(){return H},setSelectionModel:function(a){H&&(H.onSelectedRangesChanged.unsubscribe(tb),
H.destroy&&H.destroy());if(H=a)H.init(g),H.onSelectedRangesChanged.subscribe(tb)},getSelectedRows:wb,setSelectedRows:function(a){if(!H)throw"Selection model is not set";H.setSelectedRanges(wc(a))},render:B,invalidate:function(){Fa();Y();B()},invalidateRow:Bb,invalidateRows:Ab,invalidateAllRows:Y,updateCell:function(a,b){var c=G(a,b);if(c){var d=h[b],f=L(a);l&&m===a&&v===b?l.loadValue(f):(c.innerHTML=f?Aa(a,d)(a,b,Ba(f,d),d,f):"",$a(a))}},updateRow:Ya,getViewport:ya,getRenderedRange:Cb,resizeCanvas:N,
updateRowCount:Fa,scrollRowIntoView:ta,scrollRowToTop:function(a){aa(a*d.rowHeight);B()},getCanvasNode:function(){return C[0]},focus:ea,getCellFromPoint:function(a,b){for(var c=Math.floor((b+y)/d.rowHeight),e=0,f=0,g=0;g<h.length&&f<a;g++)f+=h[g].width,e++;0>e&&(e=0);return{row:c,cell:e-1}},getCellFromEvent:sa,getActiveCell:Sb,setActiveCell:function(a,b){!I||a>s()||0>a||b>=h.length||0>b||!d.enableCellNavigation||(ta(a,!1),ma(G(a,b),!1))},getActiveCellNode:function(){return n},getActiveCellPosition:Ub,
resetActiveCell:function(){ma(null,!1)},editActiveCell:Ia,getCellEditor:function(){return l},getCellNode:G,getCellNodeBox:function(a,b){if(!db(a,b))return null;for(var c=a*d.rowHeight-y,e=c+d.rowHeight-1,f=0,g=0;g<b;g++)f+=h[g].width;return{top:c,left:f,bottom:e,right:f+h[b].width}},canCellBeSelected:ub,canCellBeActive:V,navigatePrev:Hb,navigateNext:Mb,navigateUp:Lb,navigateDown:Ha,navigateLeft:Jb,navigateRight:Kb,gotoCell:Ob,getTopPanel:function(){return Xb[0]},showTopPanel:function(){d.showTopPanel=
!0;ca.slideDown("fast",N)},hideTopPanel:function(){d.showTopPanel=!1;ca.slideUp("fast",N)},showHeaderRowColumns:function(){d.showHeaderRow=!0;T.slideDown("fast",N)},hideHeaderRowColumns:function(){d.showHeaderRow=!1;T.slideUp("fast",N)},getHeaderRow:function(){return ga[0]},getHeaderRowColumn:function(a){a=K[a];return(a=ga.children().eq(a))&&a[0]},getGridPosition:function(){return Ka(p[0])},flashCell:function(a,b,c){c=c||100;if(z[a]){var e=f(G(a,b)),g=function(a){a&&setTimeout(function(){e.queue(function(){e.toggleClass(d.cellFlashingCssClass).dequeue();
g(a-1)})},c)};g(4)}},addCellCssStyles:function(a,b){if(F[a])throw"addCellCssStyles: cell CSS hash with key '"+a+"' already exists.";F[a]=b;cb(b,null);k(g.onCellCssStylesChanged,{key:a,hash:b})},setCellCssStyles:vb,removeCellCssStyles:function(a){F[a]&&(cb(null,F[a]),delete F[a],k(g.onCellCssStylesChanged,{key:a,hash:null}))},getCellCssStyles:function(a){return F[a]},init:ib,destroy:function(){r().cancelCurrentEdit();k(g.onBeforeDestroy,{});for(var a=Q.length;a--;)mb(Q[a]);d.enableColumnReorder&&q.sortable&&
q.sortable("destroy");C.parents().unbind("scroll.slickgrid");p.unbind(".slickgrid");Z.remove();$=null;C.unbind("draginit dragstart dragend drag");p.empty().removeClass(D)},getEditorLock:r,getEditController:function(){return Ja}});p=f(hb);if(1>p.length)throw Error("SlickGrid requires a valid container, "+hb+" does not exist in the DOM.");qa=qa||pc();S=S||oc();d=f.extend({},xc,d);Oa.width=d.defaultColumnWidth;if(d.enableColumnReorder&&!f.fn.sortable)throw Error("SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded");
Ja={commitCurrentEdit:function(){var a=L(m),b=h[v];if(l){if(l.isValueChanged()){var c=l.validate();if(c.valid)return m<s()?(c={row:m,cell:v,editor:l,serializedValue:l.serializeValue(),prevSerializedValue:Tb,execute:function(){this.editor.applyValue(a,this.serializedValue);Ya(this.row)},undo:function(){this.editor.applyValue(a,this.prevSerializedValue);Ya(this.row)}},d.editCommandHandler?(O(),d.editCommandHandler(a,b,c)):(c.execute(),O()),k(g.onCellChange,{row:m,cell:v,item:a})):(c={},l.applyValue(c,
l.serializeValue()),O(),k(g.onAddNewRow,{item:c,column:b})),!r().isActive();f(n).addClass("invalid");f(n).stop(!0,!0).effect("highlight",{color:"red"},300);k(g.onValidationError,{editor:l,cellNode:n,validationResults:c,row:m,cell:v,column:b});l.focus();return!1}O()}return!0},cancelCurrentEdit:function(){O();return!0}};p.empty().css("overflow","hidden").css("outline",0).addClass(D).addClass("ui-widget");/relative|absolute|fixed/.test(p.css("position"))||p.css("position","relative");Ma=f("<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>").appendTo(p);
fa=f("<div class='slick-header ui-state-default' style='overflow:hidden;position:relative;' />").appendTo(p);q=f("<div class='slick-header-columns' style='width:10000px; left:-1000px' />").appendTo(fa);T=f("<div class='slick-headerrow ui-state-default' style='overflow:hidden;position:relative;' />").appendTo(p);ga=f("<div class='slick-headerrow-columns' />").appendTo(T);ca=f("<div class='slick-top-panel-scroller ui-state-default' style='overflow:hidden;position:relative;' />").appendTo(p);Xb=f("<div class='slick-top-panel' style='width:10000px' />").appendTo(ca);
d.showTopPanel||ca.hide();d.showHeaderRow||T.hide();w=f("<div class='slick-viewport' style='width:100%;overflow:auto;outline:0;position:relative;;'>").appendTo(p);w.css("overflow-y",d.autoHeight?"hidden":"auto");C=f("<div class='grid-canvas' />").appendTo(w);d.explicitInitialization||ib()}}});var S,qa})(jQuery);